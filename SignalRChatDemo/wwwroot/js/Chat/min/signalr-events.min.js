function SetupEvents(t, e, n, a, i) { SendTyping(t, e), SendMessage(t, e), ReceiveMessage(t, n), ReceiveTyping(t, a) } function SendTyping(t, e) { $(document).on("input", "#chatInput", function () { t.invoke("Typing", e, globalIdContact).catch(function (t) { return console.error(t.toString()) }) }) } function SendMessage(i, s) { $(document).on("click", "#btnSendMessage", function () { var t, e, n, a = $("#chatInput").val().trim(); "" !== a && (i.invoke("SendMessage", s, globalIdContact, a).catch(function (t) { return console.error(t.toString()) }), t = (e = new Date).toISOString(), e = String(e.getHours()).padStart(2, "0") + ":" + String(e.getMinutes()).padStart(2, "0"), (n = $("#chatMessages")).append("<div class='message sent'><div class='message-hour'>" + e + "</div>" + a + "</div>"), n.scrollTop(n[0].scrollHeight), $("#chatInput").val(""), SendMessageToController(s, a, t), AtualizarListaDeContatos()) }) } function ReceiveMessage(t, a) { t.on("ReceiveMessage", function (e, t) { var n; e == globalIdContact ? ((n = $("#chatMessages")).append("<div class='message received'>" + t + "</div>"), n.scrollTop(n[0].scrollHeight), $("#chatInput").val(""), AtualizarListaDeContatos()) : a.find(t => t.WebId === e) || AtualizarListaDeContatos() }) } function ReceiveTyping(t, e) { t.on("UserTyping", function (t) { $("#typing-indicator-" + t).text("digitando..."), $("#last-message-" + t).css("display", "none"), t == globalIdContact && $("#typing-chatArea-" + t).text("digitando..."), clearTimeout(e), e = setTimeout(function () { $("#typing-indicator-" + t).text(""), $("#typing-chatArea-" + t).text(""), $("#last-message-" + t).css("display", "flex") }, 700) }) }